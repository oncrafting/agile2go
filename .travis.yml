language: ruby
rvm:
  - ruby 2.0.0
env:
  - DB=postgresql
before_script:
  - psql -c 'create database agile2go_test' -U postgres
  - "export CODECLIMATE_REPO_TOKEN=48356d3a75c8091d36e9ceeb7f92f39ee4b4ba3057f098a06362254cd1347c4c"
  - "export FAYE_REMOTE=http://faye-ruby-server.herokuapp.com"
  - "export DISPLAY=:99.0"
  - "sh -e /etc/init.d/xvfb start"
  - sleep 3
before_install:
  - sudo apt-add-repository -y ppa:ubuntu-sdk-team/ppa
  - sudo apt-get update
  - sudo apt-get install libqt5webkit5-dev qtdeclarative5-dev qtlocation5-dev qtsensors5-dev libgstreamer0.10-dev libgstreamer-plugins-base0.10-dev qt4-default
script:
  - bundle exec rake db:drop
  - bundle exec rake db:create
  - bundle exec rake db:migrate
  - xvfb-run -a bundle exec rspec
  - bundle exec rake jasmine:ci
